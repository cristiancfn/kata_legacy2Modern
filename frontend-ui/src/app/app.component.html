<div class="container">
  <header>
    <h1>Legacy2Modern - Motor de Migración</h1>
    <p>Transforma código legado a tecnologías modernas.</p>
  </header>

  <main class="editor-layout">
    <section class="panel input-panel">
      <div class="controls">
        <label>
          Origen:
          <select [(ngModel)]="sourceLanguage">
            <option value="COBOL">COBOL</option>
            <option value="DELPHI">Delphi</option>
          </select>
        </label>

        <label>
          Destino:
          <select [(ngModel)]="targetLanguage">
            <option value="JAVA">Java</option>
            <option value="NODEJS">Node.js</option>
          </select>
        </label>
      </div>

      <textarea
        [(ngModel)]="sourceCode"
        placeholder="Ingresar código Legacy..."
        class="code-area">
      </textarea>

      <button
        (click)="onMigrate()"
        [disabled]="isLoading"
        class="action-btn">
        {{ isLoading ? 'Procesando...' : 'Ejecutar Migración' }}
      </button>

      @if (errorMessage) {
        <div class="error-msg">
          {{ errorMessage }}
        </div>
      }
    </section>

    <section class="panel output-panel">
      <h3>Código Generado</h3>
      <div class="output-code-container">
        
        @if (result) {
          <pre><code>{{ result.generatedCode }}</code></pre>
        } @else {
          <div class="placeholder-text">El código generado aparecerá aquí.</div>
        }
      </div>

      @if (result?.report?.length) {
        <div class="report-section">
          <h3>Reporte de Migración</h3>
          <table>
            <thead>
              <tr>
                <th>Tipo</th>
                <th>Regla Aplicada</th>
                <th>Descripción</th>
              </tr>
            </thead>
            <tbody>
              @for (item of result?.report; track $index) {
                <tr [ngClass]="item.type === 'WARNING' ? 'row-warning' : 'row-applied'">
                  <td>
                    <span class="badge" [ngClass]="item.type === 'WARNING' ? 'badge-warning' : 'badge-success'">
                      {{ item.type }}
                    </span>
                  </td>
                  <td>{{ item.ruleName }}</td>
                  <td>{{ item.description }}</td>
                </tr>
              }
            </tbody>
          </table>
        </div>
      }
    </section>
  </main>
</div>